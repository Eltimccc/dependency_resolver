# dependency_resolver
Тестовое задание для собеседования в организацию

## Описание и функции
Микросервис для разрешения зависимостей между задачами и билдами.
Вводится имя билда из файла builds.yaml, затем формируется json ответ
в виде списка изз тасок по введенному биллу из файла tasks.yaml.

Например, в файле builds.yaml есть билд:
```
builds:
- name: number_sort
  tasks:
  - five
  - ten
```
Таски с зависимостями из task.yaml:
```
tasks:
- name: ten
  dependencies:
  - six
  - seven
  - eight
  - nine
- name: five
  dependencies:
  - one
  - two
  - three
  - four
```

Вывод:
```
{
  "tasks": [
    "one",
    "two",
    "three",
    "four",
    "five",
    "six",
    "seven",
    "eight",
    "nine",
    "ten"
  ]
}
```

## Технологии
- Python 3.11.1
- FastAPI 0.99.1

## Запуск проекта в dev-режиме
Эти инструкции помогут вам запустить и запустить копию проекта на вашем локальном компьютере для целей разработки и тестирования.

*Клонируем репозиторий:*
```
git clone https://github.com/Eltimccc/dependency_resolver.git
```

*Переходим в папку с проектом и устанавливаем виртуальное окружение:*

```
python3 -m venv venv
```

*Активируем виртуальное окружение:*
```
source venv/bin/activate
```

*Устанавливаем зависимости:*
```
python3 -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```

*ЗАПУСК!*
```
uvicorn app.main:app --reload
```

## Использование
Для корретного использования микросервиса, в директории проекта в папке builds есть 2 файла builds.yaml и tasks.yaml.

При старте сервис загружает tasks.yaml и builds.yaml, которые содержат задачи и билды соответственно.

После запуска проекта нужно перейти по адресу http://127.0.0.1:8000/docs.

Откроется документация swagger в которой можно выполнять запрос.
По заданию у нас выполняется POST запрос на адрес http://127.0.0.1:8000/get_tasks.

Для выполнения запроса, в swagger нужно ввести build name, тоесть имя билда из файла builds.yaml.

Ответ является JSON-объектом со списком задач, отсортированных с учетом их зависимостей.

Логика сортировки использует рекурсивный подход для обработки зависимостей задач и правильного порядка их добавления в список и находится в файле services/tasks_sort.py

В функции add_task_with_dependencies мы проверяем, есть ли у задачи зависимости в словаре dependencies_map. Если зависимость есть, то мы рекурсивно вызываем функцию add_task_with_dependencies для каждой зависимости, чтобы добавить их в список sorted_tasks перед текущей задачей.


### Автор
[Денис М. (Python-разработчик)](https://github.com/Eltimccc "Денис М (Python-разработчик)")
